NAMA   : ARNEA WANDA IZZI
NIM    : 20180801382
MATKUL : BASIS DATA
DOSEN  : MASMUR TARIGAN

//INSERT DATA
INSERT INTO ANOV_PRODUCT
VALUES ('BEAR BRAND',30)
INSERT INTO ANOV_PRODUCT
VALUES ('FRISIAN FLAG',30)
INSERT INTO ANOV_PRODUCT
VALUES ('INDOMILK',30)
//
//INSERT DATA
INSERT INTO ANOV_PURCHASE
VALUES ('BEAR BRAND',10)
INSERT INTO ANOV_PURCHASE
VALUES ('FRISIAN FLAG',10)
INSERT INTO ANOV_PURCHASE
VALUES ('INDOMILK',10)
//
//INSERT DATA
INSERT INTO ANOV_SALES
VALUES ('BEAR BRAND',5)
INSERT INTO ANOV_SALES
VALUES ('FRISIAN FLAG',5)
INSERT INTO ANOV_SALES
VALUES ('INDOMILK',5)
//

//PRODUCT
CREATE TABLE  "ANOV_PRODUCT" 
   (	"NAMA" VARCHAR2(50), 
	"QTY" NUMBER, 
	 CONSTRAINT "ANOV_PRODUCT_PK" PRIMARY KEY ("NAMA") ENABLE
   )
/

CREATE OR REPLACE TRIGGER  "BI_ANOV_PRODUCT" 
  before insert on "ANOV_PRODUCT"               
  for each row  
begin   
  if :NEW."NAMA" is null then 
    select "ANOV_PRODUCT_SEQ".nextval into :NEW."NAMA" from sys.dual; 
  end if; 
end; 

/
ALTER TRIGGER  "BI_ANOV_PRODUCT" ENABLE
/

//PURCHASE
CREATE TABLE  "ANOV_PURCHASE" 
   (	"NAMA" VARCHAR2(50), 
	"QTY" NUMBER
   )
/
ALTER TABLE  "ANOV_PURCHASE" ADD CONSTRAINT "ANOV_PURCHASE_FK" FOREIGN KEY ("NAMA")
	  REFERENCES  "ANOV_PRODUCT" ("NAMA") ENABLE
/

CREATE OR REPLACE TRIGGER  "ANOV_PURCHASE" 
before insert or update on ANOV_PURCHASE
for each row
 WHEN (new.nama is not null) begin
update ANOV_PRODUCT
set qty = qty + :new.qty
where nama = :new.nama;
end;
/
ALTER TRIGGER  "ANOV_PURCHASE" ENABLE
/

//SALES
CREATE TABLE  "ANOV_SALES" 
   (	"NAMA" VARCHAR2(50), 
	"QTY" NUMBER
   )
/
ALTER TABLE  "ANOV_SALES" ADD CONSTRAINT "ANOV_SALES_FK" FOREIGN KEY ("NAMA")
	  REFERENCES  "ANOV_PRODUCT" ("NAMA") ENABLE
/


CREATE OR REPLACE TRIGGER  "ANOV_SALES" 
before insert or update on ANOV_SALES
for each row
 WHEN (new.nama is not null) begin
update ANOV_PRODUCT
set qty = qty - :new.qty
where nama = :new.nama;
end;
/
ALTER TRIGGER  "ANOV_SALES" ENABLE
/

